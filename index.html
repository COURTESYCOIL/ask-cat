<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ask Cat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root {
            --black: #0f0f0f;
            --white: #f8f8f8;
            --yellow: #ffbc42;
            --blue: #0496ff;
            --green: #5fad56;
        }

        /* General & Menu Styles */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: 'Press Start 2P', cursive; }
        .screen { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; text-align: center; flex-direction: column; box-sizing: border-box; padding: 20px; }
        #tos-screen { background-color: var(--black); color: var(--white); }
        .tos-title { font-size: 2.5rem; margin-bottom: 20px; }
        .tos-text { font-size: 1.2rem; max-width: 600px; line-height: 1.6; margin-bottom: 40px; }
        #tos-screen .menu-button { color: var(--white); border-color: var(--white); }
        #tos-screen .menu-button:hover { color: var(--black); background-color: var(--white); }
        #start-screen { display: none; background: linear-gradient(-45deg, #ffffff, #f2f2f2, #e8e8e8, #fdfdfd); background-size: 400% 400%; animation: gradientShift 15s ease infinite; }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .header { display: flex; justify-content: center; align-items: baseline; gap: 15px; }
        .sketch-title { font-size: 4rem; color: #000; text-transform: uppercase; animation: sketchy 2s steps(2, end) infinite; }
        .version-text { font-size: 1rem; color: #333; transform: translateY(-5px); }
        @keyframes sketchy { 0% { transform: translate(0, 0) rotate(0); } 25% { transform: translate(-1px, 1px) rotate(-0.5deg); } 50% { transform: translate(1px, -1px) rotate(0.5deg); } 75% { transform: translate(1px, 1px) rotate(0); } 100% { transform: translate(0, 0) rotate(0); } }
        .menu { margin-top: 40px; display: flex; gap: 20px; justify-content: center; }
        .menu-button { display: inline-block; padding: 15px 35px; font-size: 1.5rem; text-decoration: none; text-transform: uppercase; border: 4px solid; transition: all 0.15s ease-out; }
        #start-screen .menu-button { color: #000; border-color: #000; }
        #start-screen .menu-button:hover { color: #fff; background-color: #000; transform: translateY(-4px); box-shadow: 0 8px 0 rgba(0,0,0,0.2); cursor: pointer; }
        .feedback-message { color: #e63946; font-size: 1rem; margin-top: 25px; height: 1.2em; opacity: 0; transition: opacity 0.3s ease-in-out; text-transform: none; }
        
        /* Game Screen Styles */
        #game-screen { display: none; position: relative; justify-content: center; align-items: center; background: linear-gradient(-45deg, #ffffff, #f2f2f2, #e8e8e8, #fdfdfd); background-size: 400% 400%; animation: gradientShift 15s ease infinite; }
        .cat-container { position: absolute; bottom: 120px; right: 20px; width: 200px; }
        .cat-gif { width: 100%; height: auto; cursor: pointer; }
        .pixelbubble { font-size: 1rem; font-family: "Press Start 2P", cursive; position: relative; display: inline-block; background-color: #fff; color: #000; box-shadow: 0 -3px #fff, 0 -6px #000, 3px 0 #fff, 3px -3px #000, 6px 0 #000, 0 3px #fff, 0 6px #000, -3px 0 #fff, -3px 3px #000, -6px 0 #000, -3px -3px #000, 3px 3px #000; box-sizing: border-box; line-height: 1.4em; letter-spacing: 0.08em; padding: 1em 1.5em; }
        .pixelbubble--input { padding: 0; }
        .pixelbubble--input button, .pixelbubble--input input { padding: 1em; border: 0; outline: none; background: transparent; }
        .pixelbubble--loud { text-transform: uppercase; }
        .pixelbubble--control { cursor: pointer; }
        .pixelbubble--control:active { transform: scale(0.95); }
        .pixelbubble button, .pixelbubble input { font-family: "Press Start 2P", cursive; box-sizing: border-box; letter-spacing: inherit; font-size: 1rem; }
        #ai-bubble { display: none; position: absolute; top: -120px; left: -180px; width: 350px; z-index: 10; }
        #ai-response-text { max-height: 150px; overflow-y: auto; text-align: left; }
        #user-input-container { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 80%; max-width: 700px; z-index: 20; }
        #prompt-form { display: flex; }
        #prompt-input { flex-grow: 1; }
        
        /* ========================================= */
        /* ==   NEW ACHIEVEMENTS SCREEN STYLES    == */
        /* ========================================= */
        #achievements-screen {
            display: none; /* Hidden by default */
            background-color: var(--black);
            overflow: hidden; /* Keep stars contained */
            width: 100%;
            height: 100%;
        }
        .stars, .stars2, .stars3 {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%;
            display: block;
        }
        .stars { background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAHBJREFUWAnF2EEKACAMAkDnf8rsX3so1Y1R0lIqDPnkaeK25zgp26AFLAAVeACa8AEiwAV4xG2gAbwBXeAEOIAbeAdkQAOEwA34AEnQA2ZAnsIGXAAz4A4cgDbwBDwBTuAt8AF5A1iFDf4h+gEw3y2jBwM6nAAAAABJRU5ErkJggg==) repeat top center; animation: move-twink-back 200s linear infinite; }
        .stars2 { background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIVJREFUWAnl2MEKgCAQBVA2/v+XyylhYyKkiJ3Gg9cR2BweA0eAc+AUsAFcoAZwA5bAG/gFfMABaAEOXAGbwAZwAxfAHeAGXAGL4CVwBlyBD6AFLIDfA1igA+wAn+AVeAEuQBv4BU7bA2fAGXAGPAGfwAgcgT3wBDwBS+AVeAE+AY/gD/y/3gEBhC2lJ98L5AAAAABJRU5ErkJggg==) repeat top center; animation: move-twink-back 150s linear infinite; }
        .stars3 { background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIhJREFUWAnl2MEKgCAQBVA2/v+Xy3lSJoWIbWLj8eA0g3MMCgwBR+AWXAH2wBvYAlfgBlyBq3AFboA7cAZcgc/gBTgDF8AbcAMcwFfQCnABbAAvgA/gBbyC92AJ/ALGwCswAW7BFfAAnIBDcAZcgTdgCdwBOKAZgN/gA3gCj8Ab8AG8An9g/r4CAyBfje9O8SgAAAAASUVORK5CYII=) repeat top center; animation: move-twink-back 100s linear infinite; }
        @keyframes move-twink-back { from {background-position:0 0;} to {background-position:-10000px 5000px;} }
        
        .achievements-content {
            z-index: 10;
            width: 100%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .achievements-title { font-size: 1.5rem; color: var(--green); }
        .achievement-card {
            display: flex;
            gap: 20px;
            background-color: transparent;
            border: 3px solid var(--white);
            padding: 20px;
            text-align: left;
        }
        .achievement-card.locked { opacity: 0.5; }
        .achievement-icon {
            width: 80px;
            height: 80px;
            border: 3px solid var(--blue);
            flex-shrink: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: var(--white);
        }
        .achievement-details h3 { font-size: 1rem; margin-bottom: 10px; color: var(--yellow); }
        .achievement-details p { font-size: 0.8rem; color: var(--white); text-transform: none; }

        #achievements-back-button { position: absolute; top: 20px; left: 20px; z-index: 20; color: var(--white); border: 2px solid var(--white); background: transparent; }
        #achievements-back-button:hover { background: var(--white); color: var(--black); }
    </style>
</head>
<body>
    <div id="tos-screen" class="screen">
        <h1 class="tos-title">Ask Cat TOS</h1> <p class="tos-text">Idk what to type here :P</p> <a href="#" id="accept-button" class="menu-button">Accept</a>
    </div>

    <div id="start-screen" class="screen">
        <header class="header"> <h1 class="sketch-title">Ask Cat</h1> <span class="version-text">v0.1</span> </header>
        <nav class="menu"> <a href="#" id="play-button" class="menu-button">Play</a> <a href="#" id="achievements-button" class="menu-button">Achievements</a> </nav>
        <p id="achievements-message" class="feedback-message"></p> <!-- Message is now handled by new screen -->
    </div>
    
    <div id="game-screen" class="screen">
        <a href="#" id="game-back-button" class="pixelbubble pixelbubble--control pixelbubble--loud">Back</a>
        <div class="cat-container">
            <img id="cat-image" class="cat-gif" src="ezgif-300a09fbddc6f2.gif" alt="A friendly cat">
            <div id="ai-bubble" class="pixelbubble pixelbubble--loud"> <div id="ai-response-text" class="message">Ask me something...</div> </div>
        </div>
        <div id="user-input-container" class="pixelbubble pixelbubble--input">
            <form id="prompt-form">
                <input id="prompt-input" type="text" autocomplete="off" placeholder="Ask Cat a question...">
                <button id="prompt-submit" type="submit" class="pixelbubble--control pixelbubble--loud">Ask</button>
            </form>
        </div>
    </div>

    <!-- NEW Achievements Screen -->
    <div id="achievements-screen" class="screen">
        <div class="stars"></div><div class="stars2"></div><div class="stars3"></div>
        <a href="#" id="achievements-back-button" class="pixelbubble pixelbubble--control pixelbubble--loud">Back</a>
        <div class="achievements-content">
            <h2 class="achievements-title">ACHIEVEMENTS</h2>
            <div class="achievement-card locked">
                <div class="achievement-icon">?</div>
                <div class="achievement-details">
                    <h3>First Words</h3>
                    <p>Begin your journey by asking the cat your first question.</p>
                </div>
            </div>
            <!-- More achievements will go here -->
        </div>
    </div>

    <audio id="menu-audio" loop> <source src="https://evzxirgylircpnblikrw.supabase.co/storage/v1/object/public/MOOZIK/Menu.flac" type="audio/flac"> </audio>
    <!-- NEW Achievements Audio -->
    <audio id="achievements-audio" loop><source src="https://dn721605.ca.archive.org/0/items/undertaleost_202004/Undertale%20-%20Lossless%20Soundtrack%20%28toby%20fox%29/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2020%20Mysterious%20Place.flac" type="audio/flac"></audio>

    <script>
        // Get all elements
        const tosScreen = document.getElementById('tos-screen');
        const acceptButton = document.getElementById('accept-button');
        const startScreen = document.getElementById('start-screen');
        const playButton = document.getElementById('play-button');
        const gameScreen = document.getElementById('game-screen');
        const catImage = document.getElementById('cat-image');
        const menuAudio = document.getElementById('menu-audio');
        const achievementsButton = document.getElementById('achievements-button');
        const aiBubble = document.getElementById('ai-bubble');
        const aiResponseText = document.getElementById('ai-response-text');
        const promptForm = document.getElementById('prompt-form');
        const promptInput = document.getElementById('prompt-input');
        const promptSubmit = document.getElementById('prompt-submit');
        const gameBackButton = document.getElementById('game-back-button');

        // NEW Achievements screen elements
        const achievementsScreen = document.getElementById('achievements-screen');
        const achievementsAudio = document.getElementById('achievements-audio');
        const achievementsBackButton = document.getElementById('achievements-back-button');
        
        // Event Listeners
        acceptButton.addEventListener('click', (e) => { e.preventDefault(); tosScreen.style.display = 'none'; startScreen.style.display = 'flex'; menuAudio.play().catch(console.error); });
        playButton.addEventListener('click', (e) => { e.preventDefault(); menuAudio.pause(); menuAudio.currentTime = 0; startScreen.style.display = 'none'; gameScreen.style.display = 'flex'; });
        
        // UPDATED: Achievements button now switches screens and music
        achievementsButton.addEventListener('click', (e) => {
            e.preventDefault();
            startScreen.style.display = 'none';
            achievementsScreen.style.display = 'flex';
            menuAudio.pause();
            achievementsAudio.currentTime = 0;
            achievementsAudio.play().catch(console.error);
        });

        // NEW: Back button for achievements screen
        achievementsBackButton.addEventListener('click', (e) => {
            e.preventDefault();
            achievementsScreen.style.display = 'none';
            startScreen.style.display = 'flex';
            achievementsAudio.pause();
            menuAudio.currentTime = 0;
            menuAudio.play().catch(console.error);
        });
        
        catImage.addEventListener('click', () => { const isHidden = aiBubble.style.display === 'none' || aiBubble.style.display === ''; aiBubble.style.display = isHidden ? 'block' : 'none'; });
        
        gameBackButton.addEventListener('click', (e) => {
            e.preventDefault();
            gameScreen.style.display = 'none';
            startScreen.style.display = 'flex';
            aiBubble.style.display = 'none';
            aiResponseText.innerHTML = 'Ask me something...';
            promptInput.value = '';
            menuAudio.play().catch(console.error);
        });

        promptForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userPrompt = promptInput.value.trim();
            if (!userPrompt) return;
            aiBubble.style.display = 'block';
            aiResponseText.innerHTML = '...';
            promptInput.disabled = true;
            promptSubmit.disabled = true;
            try {
                const fullPrompt = `You are a cat. Respond to the user's question as a cat would. Keep your answers short and cute. The user's question is: "${userPrompt}"`;
                const response = await puter.ai.chat(fullPrompt, { model: 'google/gemma-2-9b-it:free', stream: true, });
                aiResponseText.innerHTML = '';
                for await (const part of response) {
                    if (part.text) {
                        aiResponseText.innerHTML += part.text.replaceAll('\n', '<br>');
                        aiResponseText.scrollTop = aiResponseText.scrollHeight;
                    }
                }
            } catch (error) {
                console.error("AI Error:", error);
                aiResponseText.innerHTML = "Error!";
            } finally {
                promptInput.value = '';
                promptInput.disabled = false;
                promptSubmit.disabled = false;
                promptInput.focus();
            }
        });
    </script>
</body>
</html>
